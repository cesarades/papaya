<div class="col-12 col-lg-8 p-0">
  <% if @profile == current_user %>
    <% if @profile.organization %>
      <ul class="nav list-inline tabs-underlined" id="myTab" role="tablist">
        <li class="nav-item" role="presentation">
          <a class="tab-underlined active" id="profile-tab" data-toggle="tab" href="#profile" role="tab" aria-controls="profile" aria-selected="true">Profile</a>
        </li>
        <li class="nav-item" role="presentation">
          <a class="tab-underlined" id="upcoming-tab" data-toggle="tab" href="#upcoming" role="tab" aria-controls="upcoming" aria-selected="false">Upcoming</a>
        </li>
        <li class="nav-item" role="presentation">
          <a class="tab-underlined" id="past-tab" data-toggle="tab" href="#past" role="tab" aria-controls="past" aria-selected="false">Past</a>
        </li>
        <li class="nav-item" role="presentation">
          <a class="tab-underlined" id="create-tab" data-toggle="tab" href="#create" role="tab" aria-controls="create" aria-selected="false">Create Event</a>
        </li>
      </ul>
      <div class="tab-content" id="myTabContent">
        <div class="tab-pane fade show active" id="profile" role="tabpanel" aria-labelledby="profile-tab">
          <div class="d-flex justify-content-center">
            <% image_url = @profile.photo.attached? ? @profile.photo.key : 'https://www.pngitem.com/pimgs/m/22-223968_default-profile-picture-circle-hd-png-download.png' %>
            <%= cl_image_tag image_url, crop: :fill, radius: 100, class: 'w-20 h-20 mt-2'%>
          </div>
          <div class="text-center mt-2">
            <h1><%= @profile.name %></h1>
          </div>
          <div class="bio shadow p-4 rounded mt-3">
            <p class="m-0"><strong>Bio:</strong> <%= @profile.bio %></p>
              <%= link_to 'Log Out', destroy_user_session_path, method: :delete, class: 'btn btn-flat btn-block' %>
            </div>
        </div>
        <div class="tab-pane fade" id="upcoming" role="tabpanel" aria-labelledby="upcoming-tab">
          <div class="card-container">
            <% @upcoming.each do |event| %>
              <%= (render "shared/card-small", event: event) %>
              <%= (render "shared/card-large", event: event) %>
            <% end %>
          </div>
        </div>
        <div class="tab-pane fade" id="past" role="tabpanel" aria-labelledby="past-tab">
          <div class="card-container">
            <% @past.each do |event| %>
              <%= (render "shared/card-small", event: event) %>
              <%= (render "shared/card-large", event: event) %>
            <% end %>
          </div>
        </div>
        <div class="tab-pane fade" id="create" role="tabpanel" aria-labelledby="create-tab">
          <%= render 'shared/form-organization', event: @event %>
        </div>
      </div>
    <% else %>
      <ul class="nav list-inline tabs-underlined" id="myTab" role="tablist">
        <li class="nav-item" role="presentation">
          <a class="tab-underlined active" id="profile-tab" data-toggle="tab" href="#profile" role="tab" aria-controls="profile" aria-selected="true">Profile</a>
        </li>
        <li class="nav-item" role="presentation">
          <a class="tab-underlined" id="upcoming-tab" data-toggle="tab" href="#upcoming" role="tab" aria-controls="upcoming" aria-selected="false">Upcoming</a>
        </li>
        <li class="nav-item" role="presentation">
          <a class="tab-underlined" id="past-tab" data-toggle="tab" href="#past" role="tab" aria-controls="past" aria-selected="false">Past</a>
        </li>
        <li class="nav-item" role="presentation">
          <a class="tab-underlined" id="favorited-tab" data-toggle="tab" href="#favorited" role="tab" aria-controls="favorited" aria-selected="favorited">Favourited</a>
        </li>
      </ul>
      <div class="tab-content" id="myTabContent">
        <div class="tab-pane fade show active" id="profile" role="tabpanel" aria-labelledby="profile-tab">
          <div class="d-flex justify-content-center">
            <% image_url = @profile.photo.attached? ? @profile.photo.key : 'https://www.pngitem.com/pimgs/m/22-223968_default-profile-picture-circle-hd-png-download.png' %>
            <%= cl_image_tag image_url, crop: :fill, radius: 100, class: 'w-25 h-25 mt-2'%>
          </div>
          <div class="text-center mt-2">
            <h1><%= @profile.name %></h1>
          </div>
          <div class="bio shadow p-4 rounded mt-3">
            <p class="m-0"><strong>Bio:</strong> <%= @profile.bio %></p>
            <%= link_to 'Log out', destroy_user_session_path, method: :delete, class: 'btn btn-flat btn-block' %>
          </div>
        </div>
        <div class="tab-pane fade" id="upcoming" role="tabpanel" aria-labelledby="upcoming-tab">
          <div class="card-container">
            <% @upcoming.each do |event| %>
              <%= (render "shared/card-small", event: event) %>
              <%= (render "shared/card-large", event: event) %>
            <% end %>
          </div>
        </div>
        <div class="tab-pane fade" id="past" role="tabpanel" aria-labelledby="past-tab">
          <div class="card-container">
            <% @past.each do |event| %>
              <%= (render "shared/card-small", event: event) %>
              <%= (render "shared/card-large", event: event) %>
            <% end %>
          </div>
        </div>
        <div class="tab-pane fade" id="favorited" role="tabpanel" aria-labelledby="favorited-tab">
          <div class="card-container">
            <% @profile.all_favorited.each do |event| %>
              <%= (render "shared/card-small", event: event) %>
              <%= (render "shared/card-large", event: event) %>
            <% end %>
          </div>
        </div>
      </div>
    <% end %>
  <% else %>
    <% if @profile.organization %>
      <div class="container">
        <div class="d-flex justify-content-center">
          <%= cl_image_tag @profile.photo.key, crop: :fill, radius: 100, class: 'w-25 h-25 mt-2'%>
        </div>
        <div class="text-center mt-2">
          <h1><%= @profile.name %></h1>
        </div>
        <div class="d-flex justify-content-center align-items-center">
          <% if @following %>
            <%= link_to 'Unfollow', unfollow_user_path, method: :unfollow,  class: 'btn btn-flat btn-thin' %>
          <% else %>
            <%= link_to 'Follow', follow_user_path, method: :follow,  class: 'btn btn-flat btn-thin' %>
          <% end %>
          <% if @chatroom %>
            <%= link_to 'Message', chatroom_path(@chatroom), class: 'btn btn-flat btn-thin' %>
          <% else %>
            <%= link_to 'Start Messaging', chatrooms_path(invitee: @profile), method: :post, class: 'btn btn-flat btn-thin' %>
          <% end %>
        </div>
        <div class="bio shadow p-4 rounded mt-3">
          <p class="m-0"><strong>Bio:</strong> <%= @profile.bio %></p>
        </div>
      </div>
    <% else %>
      <div class="container">
        <div class="d-flex justify-content-center">
          <%= cl_image_tag @profile.photo.key, crop: :fill, radius: 100, class: 'w-25 h-25 mt-2'%>
        </div>
        <div class="text-center mt-2">
          <h1><%= @profile.name %></h1>
        </div>
        <div class="d-flex justify-content-center align-items-center">
          <% if @following %>
            <%= link_to 'Unfollow', unfollow_user_path, method: :unfollow,  class: 'btn btn-flat btn-thin' %>
          <% else %>
            <%= link_to 'Follow', follow_user_path, method: :follow,  class: 'btn btn-flat btn-thin' %>
          <% end %>
          <% if @chatroom %>
            <%= link_to 'Message', chatroom_path(@chatroom), class: 'btn btn-flat btn-thin' %>
          <% else %>
            <%= link_to 'Start Messaging', chatrooms_path(invitee: @profile), method: :post, class: 'btn btn-flat btn-thin' %>
          <% end %>
        </div>
        <div class="bio shadow p-4 rounded mt-3">
          <p class="m-0"><strong>Bio:</strong> <%= @profile.bio %></p>
        </div>
      </div>
    <% end %>
  <% end %>
</div>
